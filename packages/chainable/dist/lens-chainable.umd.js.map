{"version":3,"file":"lens-chainable.umd.js","sources":["../../core/dist/lens-core.umd.js","../../filters/brightness/dist/lens-filter-brightness.umd.js","../../filters/color/dist/lens-filter-color.umd.js","../../filters/colorize/dist/lens-filter-color.umd.js","../../filters/contrast/dist/lens-filter-contrast.umd.js","../../filters/gamma/dist/lens-filter-gamma.umd.js","../../filters/grayscale/dist/lens-filter-grayscale.umd.js","../../filters/invert/dist/lens-filter-grayscale.umd.js","../../filters/noise/dist/lens-filter-noise.umd.js","../../filters/sepia/dist/lens-filter-sepia.umd.js","../../filters/threshold/dist/lens-filter-threshold.umd.js","../src/utils.js","../src/index.js"],"sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (factory());\n}(this, (function () { 'use strict';\n\n    function e(e,t,n){e.addEventListener(\"message\",function(r){var o=r.data,a=o.id;if(\"RPC\"===o.type&&null!=a)if(o.method){var s=t[o.method];null==s?e.postMessage({type:\"RPC\",id:a,error:\"NO_SUCH_METHOD\"}):Promise.resolve().then(function(){return s.apply(null,o.params)}).then(function(t){e.postMessage({type:\"RPC\",id:a,result:t});}).catch(function(t){e.postMessage({type:\"RPC\",id:a,error:\"\"+t});});}else{var i=n[a];if(null==i)throw Error(\"Unknown callback \"+a);delete n[a],o.error?i[1](Error(o.error)):i[0](o.result);}});}function workerize(t,n){var r=this,o={},a=\"__xpo\"+Math.random().toString().substring(2)+\"__\";\"function\"==typeof t&&(t=\"(\"+Function.prototype.toString.call(t)+\")(\"+a+\")\"),t=function(e,t,n){return e=(e=e.replace(/^(\\s*)export\\s+default\\s+/m,function(e,r){return n.default=!0,\"\"+r+t+\".default=\"})).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm,function(e,r,o,a,s){return n[s]=!0,\"\"+r+t+\".\"+s+\"=\"+o+a+s}),\"var \"+t+\"={};\\n\"+e+\"\\n\"+t+\";\"}(t,a,o)+\"\\n(\"+Function.prototype.toString.call(e)+\")(self,\"+a+\",{})\";var s,i=URL.createObjectURL(new Blob([t])),l=new Worker(i,n),c=l.terminate,u={},p=0;for(s in l.kill=function(e){l.postMessage({type:\"KILL\",signal:e}),setTimeout(l.terminate);},l.terminate=function(){URL.revokeObjectURL(i),c.call(r);},l.call=function(e,t){return new Promise(function(n,r){var o=\"rpc\"+ ++p;u[o]=[n,r],l.postMessage({type:\"RPC\",id:o,method:e,params:t});})},l.rpcMethods={},e(l,l.rpcMethods,u),l.expose=function(e){l[s]=function(){return l.call(e,[].slice.call(arguments))};},o)s in l||l.expose(s);return l}\n\n    /**\n     * It returns a canvas with the given width and height\n     * @param {Number} w - width\n     * @param {Number} h - height\n     * @returns {Object}\n     */\n    function getCanvas(w, h) {\n        var canvas = document.createElement('canvas');\n        canvas.width = w;\n        canvas.height = h;\n\n        return canvas;\n    }\n\n    /**\n     * Given a ImageData it returns the dataURL\n     * @param {ImageData} imageData\n     * @returns {String}\n     */\n    function convertImageDataToCanvasURL(imageData) {\n        var canvas = window.document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        canvas.width = imageData.width;\n        canvas.height = imageData.height;\n        ctx.putImageData(imageData, 0, 0);\n\n        return canvas.toDataURL();\n    }\n\n    /**\n     * Given a worker file with the transformation the work is split\n     * between the configured number of workers and the transformation is applied\n     * returning a Promise\n     * @param {Object} data - image data\n     * @param {Function} transform - transformation function\n     * @param {Object} options - object to be passed to the transform function\n     * @param {Number} nWorkers - number of workers to transform the image\n     * @returns {Promise}\n     */\n    function applyFilter(_ref) {\n        var data = _ref.data,\n            transform = _ref.transform,\n            options = _ref.options,\n            nWorkers = _ref.nWorkers;\n\n        var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n        // Drawing the source image into the target canvas\n        var canvas = getCanvas(data.width, data.height);\n        var context = canvas.getContext('2d');\n        context.putImageData(data, 0, 0);\n\n        // Minimium 1 worker\n        nWorkers = nWorkers || 1;\n\n        // Height of the picture chunck for every worker\n        var blockSize = Math.floor(canvas.height / nWorkers);\n\n        return new Promise(function (resolve) {\n            var finished = 0;\n            var height = void 0;\n\n            for (var index = 0; index < nWorkers; index++) {\n                // In the last worker we have to make sure we process whatever is missing\n                height = blockSize;\n\n                if (index + 1 === nWorkers) {\n                    height = canvas.height - blockSize * index;\n                }\n\n                // Getting the picture\n                var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n                var length = height * canvas.width * 4;\n\n                worker.execute(canvasData, index, length, options).then(function (response) {\n                    // Copying back canvas data to canvas\n                    // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n                    // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n                    context.putImageData(response.result, 0, blockSize * response.index);\n\n                    finished++;\n\n                    if (finished === nWorkers) {\n                        resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n                    }\n                });\n            }\n        });\n    }\n\n    exports.getCanvas = getCanvas;\n    exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n    exports.applyFilter = applyFilter;\n\n})));\n//# sourceMappingURL=lens-core.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterBrightness = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the brightness transformation\n\t * @param {Object} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Number} [options.adjustment]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        data[i] += options.adjustment;\n\t        data[i + 1] += options.adjustment;\n\t        data[i + 2] += options.adjustment;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.adjustment] - adjustment to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction brightness() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.adjustment) {\n\t        throw new Error('lens-filter-brightness:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = brightness;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-brightness.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterColor = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the color transformation\n\t * @param {Object} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Array<ColorInterval>} [options.colorsInterval]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    /**\n\t     * Validates if param is numeric\n\t     * @param   {Number}  n\n\t     * @returns {Boolean}\n\t     */\n\t    var isNumeric = function isNumeric(n) {\n\t        return !isNaN(parseFloat(n)) && isFinite(n);\n\t    };\n\n\t    /**\n\t     * @param {Array} pixles\n\t     * @param {Number} index\n\t     * @param {Color} color\n\t     */\n\t    var applyPixelTransformation = function applyPixelTransformation(pixels, index, color) {\n\t        pixels[index] = !isNumeric(color.r) ? pixels[index] : color.r;\n\t        pixels[index + 1] = !isNumeric(color.g) ? pixels[index + 1] : color.g;\n\t        pixels[index + 2] = !isNumeric(color.b) ? pixels[index + 2] : color.b;\n\t        pixels[index + 3] = !isNumeric(color.a) ? pixels[index + 3] : color.a;\n\t    };\n\n\t    /**\n\t     * @param {Array} data\n\t     * @param {Number} index\n\t     * @param {ColorInterval} colorInterval\n\t     */\n\t    var evaluatePixel = function evaluatePixel(data, index, colorInterval) {\n\t        var red = data[index];\n\t        var green = data[index + 1];\n\t        var blue = data[index + 2];\n\n\t        return red >= colorInterval.from.r && red <= colorInterval.to.r && green >= colorInterval.from.g && green <= colorInterval.to.g && blue >= colorInterval.from.b && blue <= colorInterval.to.b;\n\t    };\n\n\t    var _loop = function _loop(i) {\n\t        options.colorsInterval.forEach(function (colorInterval) {\n\t            var isMatch = evaluatePixel(data, i, colorInterval);\n\n\t            if (isMatch && colorInterval.match) {\n\t                applyPixelTransformation(data, i, colorInterval.match);\n\t            } else if (!isMatch && colorInterval.noMatch) {\n\t                applyPixelTransformation(data, i, colorInterval.noMatch);\n\t            }\n\t        });\n\t    };\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        _loop(i);\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {ColorInterval} [options.colorsInterval] - adjustment to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction color() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.colorsInterval || !Array.isArray(options.colorsInterval)) {\n\t        throw new Error('lens-filter-color:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = color;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-color.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterColorize = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * @param {Object} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Number} [options.color]\n\t * @param {Number} [options.level]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    var hex = options.color.charAt(0) === '#' ? options.color.substr(1) : options.color;\n\t    var colorRGB = {\n\t        r: parseInt(hex.substr(0, 2), 16),\n\t        g: parseInt(hex.substr(2, 2), 16),\n\t        b: parseInt(hex.substr(4, 2), 16)\n\t    };\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        data[i] -= (data[i] - colorRGB.r) * (options.level / 100);\n\t        data[i + 1] -= (data[i + 1] - colorRGB.g) * (options.level / 100);\n\t        data[i + 2] -= (data[i + 2] - colorRGB.b) * (options.level / 100);\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.color] - color value to apply in the transformation\n\t * @param {Number} [options.level] - level value to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction colorize() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.color || !options.level) {\n\t        throw new Error('lens-filter-colorize:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = colorize;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-color.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterContrast = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the contrast transformation\n\t * @name transform\n\t * @param {Object} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Number} [options.contrast]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    var factor = 259 * (options.contrast + 255) / (255 * (259 - options.contrast));\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        data[i] = factor * (data[i] - 128) + 128;\n\t        data[i + 1] = factor * (data[i + 1] - 128) + 128;\n\t        data[i + 2] = factor * (data[i + 2] - 128) + 128;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.contrast] - contrast value to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction contrast() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.contrast) {\n\t        throw new Error('lens-filter-contrast:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = contrast;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-contrast.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterGamma = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the gamma transformation\n\t * @param {Object} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Number} [options.adjustment]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        data[i] = Math.pow(data[i] / 255, options.adjustment) * 255;\n\t        data[i + 1] = Math.pow(data[i + 1] / 255, options.adjustment) * 255;\n\t        data[i + 2] = Math.pow(data[i + 2] / 255, options.adjustment) * 255;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.adjustment] - adjustment to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction gamma() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.adjustment) {\n\t        throw new Error('lens-filter-gamma:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = gamma;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-gamma.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterGrayscale = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the grayscale transformation\n\t * @param {Object} data\n\t * @param {Number} length\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        var r = data[i];\n\t        var g = data[i + 1];\n\t        var b = data[i + 2];\n\n\t        // CIE luminance for the RGB\n\t        // The human eye is bad at seeing red and blue, so we de-emphasize them.\n\t        var v = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\t        data[i] = data[i + 1] = data[i + 2] = v;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction grayscale() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data) {\n\t        throw new Error('lens-filter-grayscale:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = grayscale;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-grayscale.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterInvert = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the invert transformation\n\t * @name transform\n\t * @param {Object} data\n\t * @param {Number} length\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        data[i] = 255 - data[i];\n\t        data[i + 1] = 255 - data[i + 1];\n\t        data[i + 2] = 255 - data[i + 2];\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @name invert\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction invert() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data) {\n\t        throw new Error('lens-filter-invert:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = invert;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-grayscale.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterNoise = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the noise transformation\n\t * @param {Array} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t * @param {Number} [options.adjustment]\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    var adjustment = Math.abs(options.adjustment) * 2.55;\n\n\t    var add = function add(original, increment) {\n\t        var result = original + increment;\n\n\t        if (result > 255) {\n\t            return 255;\n\t        } else if (result < 0) {\n\t            return 0;\n\t        }\n\n\t        return result;\n\t    };\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        // Calculate if should be negative or positive\n\t        var multiplier = Math.random() < 0.5 ? -1 : 1;\n\n\t        // Calculate random noise\n\t        var rand = multiplier * (Math.random() + adjustment);\n\n\t        data[i] = add(data[i], rand);\n\t        data[i + 1] = add(data[i + 1], rand);\n\t        data[i + 2] = add(data[i + 2], rand);\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.noise] - noise to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction noise() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.adjustment) {\n\t        throw new Error('lens-filter-noise:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = noise;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-noise.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterSepia = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the sepia transformation\n\t * @param {Object} data\n\t * @param {Number} length\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        var r = data[i];\n\t        var g = data[i + 1];\n\t        var b = data[i + 2];\n\n\t        data[i] = r * 0.393 + g * 0.769 + b * 0.189;\n\t        data[i + 1] = r * 0.349 + g * 0.686 + b * 0.168;\n\t        data[i + 2] = r * 0.272 + g * 0.534 + b * 0.131;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction sepia() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data) {\n\t        throw new Error('lens-filter-sepia:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = sepia;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-sepia.umd.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.lensFilterThreshold = {})));\n}(this, (function (exports) { 'use strict';\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar lensCore_umd = createCommonjsModule(function (module, exports) {\n\t    (function (global, factory) {\n\t        factory();\n\t    })(commonjsGlobal, function () {\n\n\t        function e(e, t, n) {\n\t            e.addEventListener(\"message\", function (r) {\n\t                var o = r.data,\n\t                    a = o.id;if (\"RPC\" === o.type && null != a) if (o.method) {\n\t                    var s = t[o.method];null == s ? e.postMessage({ type: \"RPC\", id: a, error: \"NO_SUCH_METHOD\" }) : Promise.resolve().then(function () {\n\t                        return s.apply(null, o.params);\n\t                    }).then(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, result: t });\n\t                    }).catch(function (t) {\n\t                        e.postMessage({ type: \"RPC\", id: a, error: \"\" + t });\n\t                    });\n\t                } else {\n\t                    var i = n[a];if (null == i) throw Error(\"Unknown callback \" + a);delete n[a], o.error ? i[1](Error(o.error)) : i[0](o.result);\n\t                }\n\t            });\n\t        }function workerize(t, n) {\n\t            var r = this,\n\t                o = {},\n\t                a = \"__xpo\" + Math.random().toString().substring(2) + \"__\";\"function\" == typeof t && (t = \"(\" + Function.prototype.toString.call(t) + \")(\" + a + \")\"), t = function (e, t, n) {\n\t                return e = (e = e.replace(/^(\\s*)export\\s+default\\s+/m, function (e, r) {\n\t                    return n.default = !0, \"\" + r + t + \".default=\";\n\t                })).replace(/^(\\s*)export\\s+((?:async\\s*)?function(?:\\s*\\*)?|const|let|var)(\\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm, function (e, r, o, a, s) {\n\t                    return n[s] = !0, \"\" + r + t + \".\" + s + \"=\" + o + a + s;\n\t                }), \"var \" + t + \"={};\\n\" + e + \"\\n\" + t + \";\";\n\t            }(t, a, o) + \"\\n(\" + Function.prototype.toString.call(e) + \")(self,\" + a + \",{})\";var s,\n\t                i = URL.createObjectURL(new Blob([t])),\n\t                l = new Worker(i, n),\n\t                c = l.terminate,\n\t                u = {},\n\t                p = 0;for (s in l.kill = function (e) {\n\t                l.postMessage({ type: \"KILL\", signal: e }), setTimeout(l.terminate);\n\t            }, l.terminate = function () {\n\t                URL.revokeObjectURL(i), c.call(r);\n\t            }, l.call = function (e, t) {\n\t                return new Promise(function (n, r) {\n\t                    var o = \"rpc\" + ++p;u[o] = [n, r], l.postMessage({ type: \"RPC\", id: o, method: e, params: t });\n\t                });\n\t            }, l.rpcMethods = {}, e(l, l.rpcMethods, u), l.expose = function (e) {\n\t                l[s] = function () {\n\t                    return l.call(e, [].slice.call(arguments));\n\t                };\n\t            }, o) {\n\t                s in l || l.expose(s);\n\t            }return l;\n\t        }\n\n\t        /**\n\t         * It returns a canvas with the given width and height\n\t         * @param {Number} w - width\n\t         * @param {Number} h - height\n\t         * @returns {Object}\n\t         */\n\t        function getCanvas(w, h) {\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = w;\n\t            canvas.height = h;\n\n\t            return canvas;\n\t        }\n\n\t        /**\n\t         * Given a ImageData it returns the dataURL\n\t         * @param {ImageData} imageData\n\t         * @returns {String}\n\t         */\n\t        function convertImageDataToCanvasURL(imageData) {\n\t            var canvas = window.document.createElement('canvas');\n\t            var ctx = canvas.getContext('2d');\n\t            canvas.width = imageData.width;\n\t            canvas.height = imageData.height;\n\t            ctx.putImageData(imageData, 0, 0);\n\n\t            return canvas.toDataURL();\n\t        }\n\n\t        /**\n\t         * Given a worker file with the transformation the work is split\n\t         * between the configured number of workers and the transformation is applied\n\t         * returning a Promise\n\t         * @param {Object} data - image data\n\t         * @param {Function} transform - transformation function\n\t         * @param {Object} options - object to be passed to the transform function\n\t         * @param {Number} nWorkers - number of workers to transform the image\n\t         * @returns {Promise}\n\t         */\n\t        function applyFilter(_ref) {\n\t            var data = _ref.data,\n\t                transform = _ref.transform,\n\t                options = _ref.options,\n\t                nWorkers = _ref.nWorkers;\n\n\t            var worker = workerize('\\n        var transform = ' + transform + ';\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    ');\n\n\t            // Drawing the source image into the target canvas\n\t            var canvas = getCanvas(data.width, data.height);\n\t            var context = canvas.getContext('2d');\n\t            context.putImageData(data, 0, 0);\n\n\t            // Minimium 1 worker\n\t            nWorkers = nWorkers || 1;\n\n\t            // Height of the picture chunck for every worker\n\t            var blockSize = Math.floor(canvas.height / nWorkers);\n\n\t            return new Promise(function (resolve) {\n\t                var finished = 0;\n\t                var height = void 0;\n\n\t                for (var index = 0; index < nWorkers; index++) {\n\t                    // In the last worker we have to make sure we process whatever is missing\n\t                    height = blockSize;\n\n\t                    if (index + 1 === nWorkers) {\n\t                        height = canvas.height - blockSize * index;\n\t                    }\n\n\t                    // Getting the picture\n\t                    var canvasData = context.getImageData(0, blockSize * index, canvas.width, height);\n\t                    var length = height * canvas.width * 4;\n\n\t                    worker.execute(canvasData, index, length, options).then(function (response) {\n\t                        // Copying back canvas data to canvas\n\t                        // If the first webworker  (index 0) returns data, apply it at pixel (0, 0) onwards\n\t                        // If the second webworker  (index 1) returns data, apply it at pixel (0, canvas.height/4) onwards, and so on\n\t                        context.putImageData(response.result, 0, blockSize * response.index);\n\n\t                        finished++;\n\n\t                        if (finished === nWorkers) {\n\t                            resolve(context.getImageData(0, 0, canvas.width, canvas.height));\n\t                        }\n\t                    });\n\t                }\n\t            });\n\t        }\n\n\t        exports.getCanvas = getCanvas;\n\t        exports.convertImageDataToCanvasURL = convertImageDataToCanvasURL;\n\t        exports.applyFilter = applyFilter;\n\t    });\n\t    \n\t});\n\tvar lensCore_umd_1 = lensCore_umd.getCanvas;\n\tvar lensCore_umd_2 = lensCore_umd.convertImageDataToCanvasURL;\n\tvar lensCore_umd_3 = lensCore_umd.applyFilter;\n\n\t/**\n\t * Iterate over the array applying the threshold transformation\n\t * @param {Array} data\n\t * @param {Number} length\n\t * @param {Object} options\n\t */\n\tvar transform = function transform(_ref) {\n\t    var data = _ref.data,\n\t        length = _ref.length,\n\t        options = _ref.options;\n\n\t    for (var i = 0; i < length; i += 4) {\n\t        var r = data[i];\n\t        var g = data[i + 1];\n\t        var b = data[i + 2];\n\t        var v = 0.2126 * r + 0.7152 * g + 0.0722 * b >= options.threshold ? 255 : 0;\n\t        data[i] = data[i + 1] = data[i + 2] = v;\n\t    }\n\n\t    return data;\n\t};\n\n\t/**\n\t * @param {ImageData} data - data of a image extracted from a canvas\n\t * @param {Object} options - options to pass to the transformation function\n\t * @param {Number} [options.threshold] - threshold to apply in the transformation\n\t * @param {Number} nWorkers - number of workers\n\t * @returns {Promise}\n\t */\n\tfunction threshold() {\n\t    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t        data = _ref2.data,\n\t        options = _ref2.options,\n\t        nWorkers = _ref2.nWorkers;\n\n\t    if (!data || !options || !options.threshold) {\n\t        throw new Error('lens-filter-threshold:: invalid options provided');\n\t    }\n\n\t    return lensCore_umd_3({ data: data, transform: transform, options: options, nWorkers: nWorkers });\n\t}\n\n\texports.transform = transform;\n\texports.default = threshold;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=lens-filter-threshold.umd.js.map\n","/**\n * @method getPixelsFromImage\n * @param {Object} canvas\n * @param {Object} context\n * @param {Object} imageData\n */\nexport function getPixelsFromImage(canvas, context, element) {\n    if (element.tagName !== 'IMG') {\n        throw new Error('lens-chainable:: invalid origin');\n    }\n\n    context.drawImage(element, 0, 0);\n    return context.getImageData(0, 0, canvas.width, canvas.height);\n}\n\n/**\n * Get a dom nome by selector\n * @method  getElement\n * @param   {String}   selector\n * @returns {Node}\n */\nexport function getDomElement(selector) {\n    if (!selector) {\n        throw new Error('lens-chainable:: no selector provided');\n    }\n\n    const target = document.querySelectorAll(selector)[0];\n\n    if (!target) {\n        throw new Error('lens-chainable:: no \"to\" element found');\n    }\n\n    return target;\n}\n","import { convertImageDataToCanvasURL, getCanvas } from 'lens-core';\nimport brightness from 'lens-filter-brightness';\nimport color from 'lens-filter-color';\nimport colorize from 'lens-filter-colorize';\nimport contrast from 'lens-filter-contrast';\nimport gamma from 'lens-filter-gamma';\nimport grayscale from 'lens-filter-grayscale';\nimport invert from 'lens-filter-invert';\nimport noise from 'lens-filter-noise';\nimport sepia from 'lens-filter-sepia';\nimport threshold from 'lens-filter-threshold';\n\nimport { getDomElement, getPixelsFromImage } from './utils';\n\nconst METHODS = {\n    brightness,\n    color,\n    colorize,\n    contrast,\n    gamma,\n    grayscale,\n    invert,\n    noise,\n    sepia,\n    threshold\n};\n\nconst getElement = options => {\n    if (options.url) {\n        const element = document.createElement('img');\n        element.setAttribute('src', options.url);\n\n        return element;\n    }\n\n    return getDomElement(options.from);\n};\n\nconst getImageData = options => {\n    if (options.data) return options.data;\n\n    const element = getElement(options);\n    const canvas = getCanvas(element.width, element.height);\n    const context = canvas.getContext('2d');\n\n    return getPixelsFromImage(canvas, context, element);\n};\n\nexport default class Chainable {\n    constructor(options = {}) {\n        if (!options.url && !options.data && !options.from) {\n            throw new Error('lens-chainable:: invalid options object');\n        }\n\n        this.data = getImageData(options);\n\n        if (!this.data) {\n            throw new Error('lens-chainable:: no data found');\n        }\n\n        this.filters = [];\n        this.nWorkers = options.nWorkers;\n        this.url = options.url;\n        this.from = options.from;\n    }\n\n    applyFilters() {\n        const initialValue = Promise.resolve(this.data);\n\n        return this.filters\n            .reduce(\n                (promise, item) =>\n                    promise.then(data => {\n                        const fn = METHODS[item.filter];\n                        const options = item.options;\n                        const nWorkers = this.nWorkers;\n\n                        return fn({ data, options, nWorkers });\n                    }),\n                initialValue\n            )\n            .then(data => {\n                this.data = data;\n                return data;\n            });\n    }\n\n    append(selector) {\n        return this.applyFilters().then(data => {\n            const target = getDomElement(selector);\n            const image = document.createElement('img');\n            image.setAttribute('src', convertImageDataToCanvasURL(data));\n            target.appendChild(image);\n        });\n    }\n\n    update(selector) {\n        return this.applyFilters().then(data => {\n            const target = getDomElement(selector);\n            target.setAttribute('src', convertImageDataToCanvasURL(data));\n        });\n    }\n\n    getDataURL() {\n        return convertImageDataToCanvasURL(this.data);\n    }\n}\n\nObject.keys(METHODS).forEach(method => {\n    Chainable.prototype[method] = function(options) {\n        this.filters.push({ filter: method, options });\n        return this;\n    };\n});\n"],"names":["global","factory","this","e","t","n","addEventListener","r","o","data","a","id","type","method","s","postMessage","error","Promise","resolve","then","apply","params","result","catch","i","Error","workerize","Math","random","toString","substring","Function","prototype","call","replace","default","URL","createObjectURL","Blob","l","Worker","c","terminate","u","p","kill","signal","setTimeout","revokeObjectURL","rpcMethods","expose","slice","arguments","getCanvas","w","h","canvas","document","createElement","width","height","convertImageDataToCanvasURL","imageData","window","ctx","getContext","putImageData","toDataURL","applyFilter","_ref","transform","options","nWorkers","worker","context","blockSize","floor","finished","index","canvasData","getImageData","length","execute","response","exports","commonjsGlobal","self","createCommonjsModule","fn","module","lensCore_umd","lensCore_umd_1","lensCore_umd_2","lensCore_umd_3","adjustment","brightness","_ref2","undefined","Object","defineProperty","value","isNumeric","isNaN","parseFloat","isFinite","applyPixelTransformation","pixels","color","g","b","evaluatePixel","colorInterval","red","green","blue","from","to","_loop","colorsInterval","forEach","isMatch","match","noMatch","Array","isArray","hex","charAt","substr","colorRGB","parseInt","level","colorize","factor","contrast","pow","gamma","v","grayscale","invert","abs","add","original","increment","multiplier","rand","noise","sepia","threshold","getPixelsFromImage","element","tagName","drawImage","getDomElement","selector","target","querySelectorAll","METHODS","getElement","url","setAttribute","Chainable","filters","initialValue","reduce","promise","item","filter","applyFilters","image","appendChild","keys","push"],"mappings":"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"}