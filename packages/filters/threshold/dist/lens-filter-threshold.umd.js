!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.lensFilterThreshold={})}(this,function(t){"use strict";var e,n=(function(t,e){!function(){function h(a,i,s){a.addEventListener("message",function(t){var e=t.data,n=e.id;if("RPC"===e.type&&null!=n)if(e.method){var r=i[e.method];null==r?a.postMessage({type:"RPC",id:n,error:"NO_SUCH_METHOD"}):Promise.resolve().then(function(){return r.apply(null,e.params)}).then(function(t){a.postMessage({type:"RPC",id:n,result:t})}).catch(function(t){a.postMessage({type:"RPC",id:n,error:""+t})})}else{var o=s[n];if(null==o)throw Error("Unknown callback "+n);delete s[n],e.error?o[1](Error(e.error)):o[0](e.result)}})}function r(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}e.getCanvas=r,e.convertImageDataToCanvasURL=function(t){var e=window.document.createElement("canvas"),n=e.getContext("2d");return e.width=t.width,e.height=t.height,n.putImageData(t,0,0),e.toDataURL()},e.applyFilter=function(t){var e=t.data,n=t.transform,i=t.options,s=t.nWorkers,c=function(t,e){var n,a,i,r=this,o={},s="__xpo"+Math.random().toString().substring(2)+"__";"function"==typeof t&&(t="("+Function.prototype.toString.call(t)+")("+s+")"),a=s,i=o,n=(n=(n=t).replace(/^(\s*)export\s+default\s+/m,function(t,e){return i.default=!0,""+e+a+".default="})).replace(/^(\s*)export\s+((?:async\s*)?function(?:\s*\*)?|const|let|var)(\s+)([a-zA-Z$_][a-zA-Z0-9$_]*)/gm,function(t,e,n,r,o){return i[o]=!0,""+e+a+"."+o+"="+n+r+o}),t="var "+a+"={};\n"+n+"\n"+a+";\n("+Function.prototype.toString.call(h)+")(self,"+s+",{})";var c,l=URL.createObjectURL(new Blob([t])),u=new Worker(l,void 0),d=u.terminate,f={},p=0;for(c in u.kill=function(t){u.postMessage({type:"KILL",signal:t}),setTimeout(u.terminate)},u.terminate=function(){URL.revokeObjectURL(l),d.call(r)},u.call=function(r,o){return new Promise(function(t,e){var n="rpc"+ ++p;f[n]=[t,e],u.postMessage({type:"RPC",id:n,method:r,params:o})})},u.rpcMethods={},h(u,u.rpcMethods,f),u.expose=function(t){u[c]=function(){return u.call(t,[].slice.call(arguments))}},o)c in u||u.expose(c);return u}("\n        var transform = "+n+";\n\n        export function execute(canvas, index, length, options) {\n            canvas.data = transform({ \n                data: canvas.data, \n                length: length, \n                options: options\n            });\n\n            return { result: canvas, index: index };\n        }\n    "),l=r(e.width,e.height),u=l.getContext("2d");u.putImageData(e,0,0),s=s||1;var d=Math.floor(l.height/s);return new Promise(function(e){for(var n=0,t=void 0,r=0;r<s;r++){t=d,r+1===s&&(t=l.height-d*r);var o=u.getImageData(0,d*r,l.width,t),a=t*l.width*4;c.execute(o,r,a,i).then(function(t){u.putImageData(t.result,0,d*t.index),++n===s&&e(u.getImageData(0,0,l.width,l.height))})}})}}()}(e={exports:{}},e.exports),e.exports),o=(n.getCanvas,n.convertImageDataToCanvasURL,n.applyFilter),a=function(t){for(var e=t.data,n=t.length,r=t.options,o=0;o<n;o+=4){var a=.2126*e[o]+.7152*e[o+1]+.0722*e[o+2]>=r.level?255:0;e[o]=e[o+1]=e[o+2]=a}return e};t.transform=a,t.default=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.options,r=t.nWorkers;if(!e||!n||!n.level)throw new Error("lens-filter-threshold:: invalid options provided");return o({data:e,transform:a,options:n,nWorkers:r})},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=lens-filter-threshold.umd.js.map
