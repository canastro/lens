{"version":3,"file":"lens-filter-color.umd.js","sources":["../../../core/dist/lens-core.umd.js","../src/index.js"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?e(require(\"workerize\")):\"function\"==typeof define&&define.amd?define([\"workerize\"],e):e(t.workerize)}(this,function(a){\"use strict\";function o(t,e){var n=document.createElement(\"canvas\");return n.width=t,n.height=e,n}a=a&&a.hasOwnProperty(\"default\")?a.default:a,exports.getCanvas=o,exports.convertImageDataToCanvasURL=function(t){var e=window.document.createElement(\"canvas\"),n=e.getContext(\"2d\");return e.width=t.width,e.height=t.height,n.putImageData(t,0,0),e.toDataURL()},exports.applyFilter=function(t){var e=t.data,n=t.transform,i=t.options,d=t.nWorkers,h=a(\"\\n        var transform = \"+n+\";\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    \"),u=o(e.width,e.height),s=u.getContext(\"2d\");s.putImageData(e,0,0),d=d||1;var c=Math.floor(u.height/d);return new Promise(function(e){for(var n=0,t=void 0,a=0;a<d;a++){t=c,a+1===d&&(t=u.height-c*a);var o=s.getImageData(0,c*a,u.width,t),r=t*u.width*4;h.execute(o,a,r,i).then(function(t){s.putImageData(t.result,0,c*t.index),++n===d&&e(s.getImageData(0,0,u.width,u.height))})}})}});\n//# sourceMappingURL=lens-core.umd.js.map\n","import { applyFilter } from 'lens-core';\n\n/**\n * Iterate over the array applying the color transformation\n * @param {Object} data\n * @param {Number} length\n * @param {Object} options\n * @param {Array<ColorInterval>} [options.colorsInterval]\n */\nexport const transform = ({ data, length, options }) => {\n    /**\n     * Validates if param is numeric\n     * @param   {Number}  n\n     * @returns {Boolean}\n     */\n    const isNumeric = n => !isNaN(parseFloat(n)) && isFinite(n);\n\n    /**\n     * @param {Array} pixles\n     * @param {Number} index\n     * @param {Color} color\n     */\n    const applyPixelTransformation = (pixels, index, color) => {\n        pixels[index] = !isNumeric(color.r) ? pixels[index] : color.r;\n        pixels[index + 1] = !isNumeric(color.g) ? pixels[index + 1] : color.g;\n        pixels[index + 2] = !isNumeric(color.b) ? pixels[index + 2] : color.b;\n        pixels[index + 3] = !isNumeric(color.a) ? pixels[index + 3] : color.a;\n    };\n\n    /**\n     * @param {Array} data\n     * @param {Number} index\n     * @param {ColorInterval} colorInterval\n     */\n    const evaluatePixel = (data, index, colorInterval) => {\n        const red = data[index];\n        const green = data[index + 1];\n        const blue = data[index + 2];\n\n        return (\n            red >= colorInterval.from.r &&\n            red <= colorInterval.to.r &&\n            green >= colorInterval.from.g &&\n            green <= colorInterval.to.g &&\n            blue >= colorInterval.from.b &&\n            blue <= colorInterval.to.b\n        );\n    };\n\n    for (let i = 0; i < length; i += 4) {\n        options.colorsInterval.forEach(colorInterval => {\n            const isMatch = evaluatePixel(data, i, colorInterval);\n\n            if (isMatch && colorInterval.match) {\n                applyPixelTransformation(data, i, colorInterval.match);\n            } else if (!isMatch && colorInterval.noMatch) {\n                applyPixelTransformation(data, i, colorInterval.noMatch);\n            }\n        });\n    }\n\n    return data;\n};\n\n/**\n * @param {ImageData} data - data of a image extracted from a canvas\n * @param {Object} options - options to pass to the transformation function\n * @param {ColorInterval} [options.colorsInterval] - colorsInterval to apply in the transformation\n * @param {Number} nWorkers - number of workers\n * @returns {Promise}\n */\nexport default function color({ data, options, nWorkers } = {}) {\n    if (\n        !data ||\n        !options ||\n        !options.colorsInterval ||\n        !Array.isArray(options.colorsInterval)\n    ) {\n        throw new Error('lens-filter-color:: invalid options provided');\n    }\n\n    return applyFilter({ data, transform, options, nWorkers });\n}\n"],"names":["a","o","t","e","n","document","createElement","width","height","hasOwnProperty","default","exports","window","getContext","putImageData","toDataURL","data","transform","i","options","d","nWorkers","h","u","s","c","Math","floor","Promise","getImageData","r","execute","then","result","index","require$$0","length","isNumeric","isNaN","parseFloat","isFinite","applyPixelTransformation","pixels","color","g","b","colorsInterval","forEach","colorInterval","red","green","blue","isMatch","from","to","match","noMatch","Array","isArray","Error","applyFilter"],"mappings":"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"}