{"version":3,"file":"lens-filter-noise.umd.js","sources":["../../../core/dist/lens-core.umd.js","../src/index.js"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?e(require(\"workerize\")):\"function\"==typeof define&&define.amd?define([\"workerize\"],e):e(t.workerize)}(this,function(a){\"use strict\";function o(t,e){var n=document.createElement(\"canvas\");return n.width=t,n.height=e,n}a=a&&a.hasOwnProperty(\"default\")?a.default:a,exports.getCanvas=o,exports.convertImageDataToCanvasURL=function(t){var e=window.document.createElement(\"canvas\"),n=e.getContext(\"2d\");return e.width=t.width,e.height=t.height,n.putImageData(t,0,0),e.toDataURL()},exports.applyFilter=function(t){var e=t.data,n=t.transform,i=t.options,d=t.nWorkers,h=a(\"\\n        var transform = \"+n+\";\\n\\n        export function execute(canvas, index, length, options) {\\n            canvas.data = transform({ \\n                data: canvas.data, \\n                length: length, \\n                options: options\\n            });\\n\\n            return { result: canvas, index: index };\\n        }\\n    \"),u=o(e.width,e.height),s=u.getContext(\"2d\");s.putImageData(e,0,0),d=d||1;var c=Math.floor(u.height/d);return new Promise(function(e){for(var n=0,t=void 0,a=0;a<d;a++){t=c,a+1===d&&(t=u.height-c*a);var o=s.getImageData(0,c*a,u.width,t),r=t*u.width*4;h.execute(o,a,r,i).then(function(t){s.putImageData(t.result,0,c*t.index),++n===d&&e(s.getImageData(0,0,u.width,u.height))})}})}});\n//# sourceMappingURL=lens-core.umd.js.map\n","import { applyFilter } from 'lens-core';\n\n/**\n * Iterate over the array applying the noise transformation\n * @param {Array} data\n * @param {Number} length\n * @param {Object} options\n * @param {Number} [options.level]\n */\nexport const transform = ({ data, length, options }) => {\n    const level = Math.abs(options.level) * 2.55;\n\n    const add = (original, increment) => {\n        const result = original + increment;\n\n        if (result > 255) {\n            return 255;\n        } else if (result < 0) {\n            return 0;\n        }\n\n        return result;\n    };\n\n    for (let i = 0; i < length; i += 4) {\n        // Calculate if should be negative or positive\n        const multiplier = Math.random() < 0.5 ? -1 : 1;\n\n        // Calculate random noise\n        const rand = multiplier * (Math.random() + level);\n\n        data[i] = add(data[i], rand);\n        data[i + 1] = add(data[i + 1], rand);\n        data[i + 2] = add(data[i + 2], rand);\n    }\n\n    return data;\n};\n\n/**\n * @param {ImageData} data - data of a image extracted from a canvas\n * @param {Object} options - options to pass to the transformation function\n * @param {Number} [options.noise] - noise to apply in the transformation\n * @param {Number} nWorkers - number of workers\n * @returns {Promise}\n */\nexport default function noise({ data, options, nWorkers } = {}) {\n    if (!data || !options || !options.level) {\n        throw new Error('lens-filter-noise:: invalid options provided');\n    }\n\n    return applyFilter({ data, transform, options, nWorkers });\n}\n"],"names":["a","o","t","e","n","document","createElement","width","height","hasOwnProperty","default","exports","window","getContext","putImageData","toDataURL","data","transform","i","options","d","nWorkers","h","u","s","c","Math","floor","Promise","getImageData","r","execute","then","result","index","require$$0","length","level","abs","add","original","increment","rand","random","Error","applyFilter"],"mappings":"yZAA+K,SAASA,YAAyBC,EAAEC,EAAEC,OAAOC,EAAEC,SAASC,cAAc,UAAU,OAAOF,EAAEG,MAAML,EAAEE,EAAEI,OAAOL,EAAEC,IAAIJ,GAAGA,EAAES,eAAe,WAAWT,EAAEU,QAAQV,EAAEW,YAAkBV,EAAEU,8BAAoC,SAAST,OAAOC,EAAES,OAAOP,SAASC,cAAc,UAAUF,EAAED,EAAEU,WAAW,MAAM,OAAOV,EAAEI,MAAML,EAAEK,MAAMJ,EAAEK,OAAON,EAAEM,OAAOJ,EAAEU,aAAaZ,EAAE,EAAE,GAAGC,EAAEY,aAAaJ,cAAoB,SAAST,OAAOC,EAAED,EAAEc,KAAKZ,EAAEF,EAAEe,UAAUC,EAAEhB,EAAEiB,QAAQC,EAAElB,EAAEmB,SAASC,EAAEtB,EAAE,6BAA6BI,EAAE,qTAAqTmB,EAAEtB,EAAEE,EAAEI,MAAMJ,EAAEK,QAAQgB,EAAED,EAAEV,WAAW,MAAMW,EAAEV,aAAaX,EAAE,EAAE,GAAGiB,EAAEA,GAAG,EAAE,IAAIK,EAAEC,KAAKC,MAAMJ,EAAEf,OAAOY,GAAG,OAAO,IAAIQ,QAAQ,SAASzB,OAAO,IAAIC,EAAE,EAAEF,OAAE,EAAOF,EAAE,EAAEA,EAAEoB,EAAEpB,IAAI,GAAGyB,EAAEzB,EAAE,IAAIoB,IAAIlB,EAAEqB,EAAEf,OAAOiB,EAAEzB,GAAG,IAAIC,EAAEuB,EAAEK,aAAa,EAAEJ,EAAEzB,EAAEuB,EAAEhB,MAAML,GAAG4B,EAAE5B,EAAEqB,EAAEhB,MAAM,EAAEe,EAAES,QAAQ9B,EAAED,EAAE8B,EAAEZ,GAAGc,KAAK,SAAS9B,KAAKY,aAAaZ,EAAE+B,OAAO,EAAER,EAAEvB,EAAEgC,SAAS9B,IAAIgB,GAAGjB,EAAEqB,EAAEK,aAAa,EAAE,EAAEN,EAAEhB,MAAMgB,EAAEf,gBAA9uC2B,qGCSzDlB,EAAY,oBAAGD,IAAAA,KAAMoB,IAAAA,OAAQjB,IAAAA,QAChCkB,EAAkC,KAA1BX,KAAKY,IAAInB,EAAQkB,OAEzBE,EAAM,SAACC,EAAUC,OACbR,EAASO,EAAWC,SAEb,IAATR,EACO,IACAA,EAAS,EACT,EAGJA,GAGFf,EAAI,EAAGA,EAAIkB,EAAQlB,GAAK,EAAG,KAK1BwB,GAHahB,KAAKiB,SAAW,IAAO,EAAI,IAGnBjB,KAAKiB,SAAWN,KAEtCnB,GAAKqB,EAAIvB,EAAKE,GAAIwB,KAClBxB,EAAI,GAAKqB,EAAIvB,EAAKE,EAAI,GAAIwB,KAC1BxB,EAAI,GAAKqB,EAAIvB,EAAKE,EAAI,GAAIwB,UAG5B1B,2BAUI,wEAA6C,GAA5BA,IAAAA,KAAMG,IAAAA,QAASE,IAAAA,aACtCL,IAASG,IAAYA,EAAQkB,YACxB,IAAIO,MAAM,uDAGbC,EAAY,CAAE7B,OAAMC,YAAWE,UAASE"}